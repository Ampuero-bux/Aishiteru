<!doctype html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Galaxia de Amor</title>
  <style>
    :root {
      --bg0: #050711;
      --bg1: #101a46;
      --pink: #ff5da9;
      --cyan: #76e4ff;
      --text: #eff4ff;
      --muted: #b9c8ff;
      --glass: rgba(8, 12, 30, 0.72);
      --line: rgba(255, 255, 255, 0.22);
    }

    * { box-sizing: border-box; }

    html, body {
      margin: 0;
      width: 100%;
      height: 100%;
      overflow: hidden;
      font-family: "Avenir Next", "Segoe UI", sans-serif;
      color: var(--text);
      background: radial-gradient(circle at 20% 20%, #2a3182 0%, var(--bg1) 36%, var(--bg0) 100%);
    }

    #space {
      position: fixed;
      inset: 0;
      width: 100%;
      height: 100%;
      display: block;
      z-index: 1;
    }

    .screen {
      position: fixed;
      inset: 0;
      z-index: 3;
      display: grid;
      place-items: center;
      padding: 1rem;
    }

    .card {
      width: min(92vw, 680px);
      background: var(--glass);
      border: 1px solid var(--line);
      border-radius: 22px;
      padding: 1.7rem 1.2rem;
      text-align: center;
      backdrop-filter: blur(8px);
      box-shadow: 0 20px 60px rgba(0, 0, 0, 0.55);
      transition: opacity .6s ease, transform .6s ease;
    }

    .card.hidden {
      opacity: 0;
      transform: scale(.96);
      pointer-events: none;
    }

    h1 {
      margin: 0;
      font-size: clamp(2rem, 6vw, 2.9rem);
      text-shadow: 0 0 24px rgba(255, 93, 169, .45);
    }

    p {
      margin: .7rem 0 1.4rem;
      color: var(--muted);
      font-size: clamp(1rem, 2.8vw, 1.15rem);
    }

    .actions {
      position: relative;
      display: flex;
      justify-content: center;
      gap: .8rem;
      min-height: 92px;
      flex-wrap: wrap;
    }

    button {
      border: 0;
      border-radius: 999px;
      padding: .85rem 1.45rem;
      font-size: 1rem;
      font-weight: 800;
      cursor: pointer;
      transition: transform .2s ease;
    }

    #yesBtn {
      background: linear-gradient(120deg, var(--pink), #ff9dcf);
      color: #fff;
      box-shadow: 0 10px 28px rgba(255, 93, 169, .45);
    }

    #yesBtn:hover { transform: translateY(-2px) scale(1.03); }

    #noBtn {
      background: linear-gradient(120deg, #5d657d, #848ca7);
      color: #fff;
      position: relative;
    }

    #status {
      min-height: 30px;
      margin-top: .9rem;
      color: #ffd98d;
      font-weight: 700;
    }

    .travel {
      position: fixed;
      inset: 0;
      z-index: 4;
      pointer-events: none;
      opacity: 0;
      transition: opacity .6s ease;
      display: block;
    }

    .travel.active { opacity: 1; }

    .message {
      width: min(92vw, 740px);
      position: absolute;
      top: 8%;
      left: 50%;
      transform: translateX(-50%) translateY(16px);
      text-align: center;
      font-size: clamp(0.95rem, 3.2vw, 1.7rem);
      font-weight: 900;
      line-height: 1.2;
      color: #fff;
      text-shadow: 0 0 20px rgba(255,255,255,.55), 0 0 45px rgba(255,93,169,.35);
      padding: 0 .8rem;
      opacity: 0;
      transition: opacity .7s ease, transform .7s ease;
    }

    .message.show {
      opacity: 1;
      transform: translateX(-50%) translateY(0);
    }
  </style>
</head>
<body>
  <canvas id="space" aria-hidden="true"></canvas>

  <div class="screen">
    <main class="card" id="card">
      <h1>쯈uieres ser mi novia? 游눘</h1>
      <p>Desde que te conoc칤, mi mundo es m치s feliz y brillante. Admiro tu esencia y tu forma de ver la vida. No quiero caminar ni atr치s ni adelante de ti, sino siempre a tu lado.</p>

      <div class="actions" id="actions">
        <button id="yesBtn">S칤, quiero</button>
        <button id="noBtn">No</button>
      </div>

      <div id="status" aria-live="polite"></div>
    </main>
  </div>

  <section class="travel" id="travel" aria-hidden="true">
    <div class="message" id="mainMessage"></div>
  </section>

  <script>
    const canvas = document.getElementById('space');
    const ctx = canvas.getContext('2d');

    const card = document.getElementById('card');
    const actions = document.getElementById('actions');
    const yesBtn = document.getElementById('yesBtn');
    const noBtn = document.getElementById('noBtn');
    const status = document.getElementById('status');
    const travel = document.getElementById('travel');
    const mainMessage = document.getElementById('mainMessage');

    let w = innerWidth;
    let h = innerHeight;
    let cx = w / 2;
    let cy = h / 2;
    const dpr = Math.max(1, Math.min(devicePixelRatio || 1, 2));

    let running = false;
    let speed = 0.35;
    let targetSpeed = 0.35;
    let noFloats = true;

    const worlds = [];
    const comets = [];
    const ambientStars = [];
    const skyComets = [];
    const messages = ['Te amo', 'Mi amor', 'Mi vida', 'Contigo', 'Siempre', 'Eres t칰', 'Mi universo'];
    const phrases = [
      'Tu sonrisa ilumina m치s que toda Andr칩meda.',
      'Quiero escribir nuestra historia entre estrellas.',
      'Mi lugar favorito del universo eres t칰.',
      'Contigo, todo se siente m치gico.'
    ];

    let phraseIndex = 0;
    let phraseTimer = null;

    function resize() {
      w = innerWidth;
      h = innerHeight;
      cx = w / 2;
      cy = h / 2;
      canvas.width = Math.floor(w * dpr);
      canvas.height = Math.floor(h * dpr);
      canvas.style.width = w + 'px';
      canvas.style.height = h + 'px';
      ctx.setTransform(dpr, 0, 0, dpr, 0, 0);

      if (!worlds.length) {
        const worldCount = 10;
        for (let i = 0; i < worldCount; i++) {
          worlds.push({
            arm: i % 2,
            progress: Math.random(),
            speed: 0.18 + Math.random() * 0.45,
            size: 7 + Math.random() * 16,
            ring: Math.random() > 0.6,
            hueA: 165 + Math.random() * 120,
            hueB: 250 + Math.random() * 90
          });
        }
      }

      if (!comets.length) {
        const cometCount = 18;
        for (let i = 0; i < cometCount; i++) {
          comets.push({
            arm: i % 2,
            progress: Math.random(),
            speed: 0.04 + Math.random() * 0.07,
            size: 1.8 + Math.random() * 1.8,
            hue: Math.random() > 0.5 ? 195 : 325
          });
        }
      }

      if (!ambientStars.length) {
        const starCount = Math.max(220, Math.floor((w * h) / 4500));
        for (let i = 0; i < starCount; i++) {
          ambientStars.push({
            x: Math.random() * w,
            y: Math.random() * h,
            r: 0.4 + Math.random() * 1.3,
            phase: Math.random() * Math.PI * 2
          });
        }
      }

      if (!skyComets.length) {
        for (let i = 0; i < 14; i++) skyComets.push(makeSkyComet());
      }
    }

    function makeSkyComet() {
      const fromLeft = Math.random() > 0.5;
      const x = fromLeft ? -120 : w + 120;
      const y = Math.random() * h * 0.65;
      const vx = fromLeft ? 4 + Math.random() * 3 : -(4 + Math.random() * 3);
      const vy = 1.2 + Math.random() * 1.8;
      return {
        x,
        y,
        vx,
        vy,
        size: 1.8 + Math.random() * 1.8,
        life: 220 + Math.random() * 180
      };
    }

    function drawBackground() {
      const g = ctx.createRadialGradient(cx, cy, 0, cx, cy, Math.max(w, h) * 0.9);
      g.addColorStop(0, '#121f57');
      g.addColorStop(0.42, '#091130');
      g.addColorStop(1, '#040711');
      ctx.fillStyle = g;
      ctx.fillRect(0, 0, w, h);
    }

    function drawGlobalEffects() {
      ctx.save();
      for (let i = 0; i < ambientStars.length; i++) {
        const s = ambientStars[i];
        const tw = 0.3 + 0.7 * (0.5 + 0.5 * Math.sin(performance.now() * 0.0015 + s.phase));
        ctx.fillStyle = `rgba(255,255,255,${tw * 0.5})`;
        ctx.beginPath();
        ctx.arc(s.x, s.y, s.r, 0, Math.PI * 2);
        ctx.fill();
      }

      for (let i = 0; i < skyComets.length; i++) {
        const c = skyComets[i];
        c.x += c.vx;
        c.y += c.vy;
        c.life -= 1;

        const tx = c.x - c.vx * 10;
        const ty = c.y - c.vy * 10;
        const grad = ctx.createLinearGradient(c.x, c.y, tx, ty);
        grad.addColorStop(0, 'rgba(185,240,255,0.9)');
        grad.addColorStop(1, 'rgba(255,255,255,0)');
        ctx.strokeStyle = grad;
        ctx.lineWidth = c.size * 1.9;
        ctx.beginPath();
        ctx.moveTo(c.x, c.y);
        ctx.lineTo(tx, ty);
        ctx.stroke();

        ctx.fillStyle = 'rgba(220,250,255,0.95)';
        ctx.beginPath();
        ctx.arc(c.x, c.y, c.size, 0, Math.PI * 2);
        ctx.fill();

        if (c.life <= 0 || c.y > h + 80 || c.x < -140 || c.x > w + 140) {
          skyComets[i] = makeSkyComet();
        }
      }
      ctx.restore();
    }

    function drawSpiralGalaxy() {
      if (!running) return;

      const t = performance.now() * 0.00042;
      const pulse = 0.9 + Math.sin(performance.now() * 0.003) * 0.09;
      const base = Math.min(w, h) * 0.22 * pulse;

      const core = ctx.createRadialGradient(cx, cy, 0, cx, cy, base * 2.5);
      core.addColorStop(0, 'rgba(255,255,255,.97)');
      core.addColorStop(0.22, 'rgba(145,227,255,.82)');
      core.addColorStop(0.55, 'rgba(255,109,198,.38)');
      core.addColorStop(1, 'rgba(0,0,0,0)');
      ctx.fillStyle = core;
      ctx.beginPath();
      ctx.arc(cx, cy, base * 2.5, 0, Math.PI * 2);
      ctx.fill();

      ctx.save();
      ctx.translate(cx, cy);
      ctx.globalAlpha = 0.3;
      for (let arm = 0; arm < 2; arm++) {
        ctx.beginPath();
        for (let q = 0; q < 10 * Math.PI; q += 0.05) {
          const rr = 3 + q * 12.5;
          const a = q + arm * Math.PI + t;
          const x = Math.cos(a) * rr;
          const y = Math.sin(a) * rr * 0.52;
          if (q === 0) ctx.moveTo(x, y); else ctx.lineTo(x, y);
        }
        ctx.strokeStyle = arm ? 'rgba(255,170,226,.52)' : 'rgba(157,234,255,.52)';
        ctx.lineWidth = 2;
        ctx.stroke();
      }
      ctx.restore();

      drawSpiralStars(t, base);
      drawSpiralWorlds(t, base);
      drawSpiralComets(t, base);
      drawOrbitMessages(t, base);
    }

    function drawSpiralStars(t, base) {
      ctx.save();
      for (let i = 0; i < 260; i++) {
        const arm = i % 2;
        const q = (i / 260) * 10 * Math.PI;
        const rr = 3 + q * 12.5;
        const a = q + arm * Math.PI + t;
        const x = cx + Math.cos(a) * rr;
        const y = cy + Math.sin(a) * rr * 0.52;
        const twinkle = 0.35 + 0.65 * (0.5 + 0.5 * Math.sin(t * 10 + i));

        ctx.fillStyle = `rgba(255,255,255,${twinkle * 0.8})`;
        ctx.beginPath();
        ctx.arc(x, y, 0.6 + (i % 3) * 0.4, 0, Math.PI * 2);
        ctx.fill();
      }
      ctx.restore();
    }

    function drawSpiralWorlds(t, base) {
      ctx.save();
      for (let i = 0; i < worlds.length; i++) {
        const wld = worlds[i];
        wld.progress += wld.speed * 0.0018 * speed;
        if (wld.progress > 1) wld.progress = 0;

        const q = wld.progress * 10 * Math.PI;
        const rr = 3 + q * 12.5;
        const a = q + wld.arm * Math.PI + t;
        const x = cx + Math.cos(a) * rr;
        const y = cy + Math.sin(a) * rr * 0.52;

        const g = ctx.createRadialGradient(
          x - wld.size * 0.35,
          y - wld.size * 0.4,
          wld.size * 0.2,
          x,
          y,
          wld.size
        );
        g.addColorStop(0, `hsl(${wld.hueA},95%,84%)`);
        g.addColorStop(0.55, `hsl(${wld.hueA},72%,53%)`);
        g.addColorStop(1, `hsl(${wld.hueB},80%,30%)`);
        ctx.fillStyle = g;
        ctx.beginPath();
        ctx.arc(x, y, wld.size, 0, Math.PI * 2);
        ctx.fill();

        if (wld.ring) {
          ctx.save();
          ctx.translate(x, y);
          ctx.rotate(a * 0.55);
          ctx.strokeStyle = 'rgba(230,238,255,0.5)';
          ctx.lineWidth = Math.max(1, wld.size * 0.1);
          ctx.beginPath();
          ctx.ellipse(0, 0, wld.size * 1.55, wld.size * 0.45, 0, 0, Math.PI * 2);
          ctx.stroke();
          ctx.restore();
        }
      }
      ctx.restore();
    }

    function drawSpiralComets(t, base) {
      ctx.save();
      for (const c of comets) {
        c.progress += c.speed * 0.0035 * speed;
        if (c.progress > 1) c.progress = 0;

        const q = c.progress * 10 * Math.PI;
        const rr = 3 + q * 12.5;
        const a = q + c.arm * Math.PI + t;
        const x = cx + Math.cos(a) * rr;
        const y = cy + Math.sin(a) * rr * 0.52;

        // Trazo del cometa siguiendo la direcci칩n local de la espiral.
        const prevQ = Math.max(0, q - 0.35);
        const prevR = 3 + prevQ * 12.5;
        const prevA = prevQ + c.arm * Math.PI + t;
        const px = cx + Math.cos(prevA) * prevR;
        const py = cy + Math.sin(prevA) * prevR * 0.52;

        const tail = ctx.createLinearGradient(x, y, px, py);
        tail.addColorStop(0, c.hue === 195 ? 'rgba(125,230,255,0.95)' : 'rgba(255,140,220,0.95)');
        tail.addColorStop(1, 'rgba(255,255,255,0)');
        ctx.strokeStyle = tail;
        ctx.lineWidth = c.size * 1.8;
        ctx.beginPath();
        ctx.moveTo(x, y);
        ctx.lineTo(px, py);
        ctx.stroke();

        ctx.shadowColor = c.hue === 195 ? 'rgba(120,230,255,0.9)' : 'rgba(255,125,214,0.9)';
        ctx.shadowBlur = 18;
        ctx.fillStyle = c.hue === 195 ? 'rgba(205,246,255,1)' : 'rgba(255,220,245,1)';
        ctx.beginPath();
        ctx.arc(x, y, c.size, 0, Math.PI * 2);
        ctx.fill();
      }
      ctx.restore();
    }

    function drawOrbitMessages(t, base) {
      const spread = base * 3.3;

      ctx.save();
      ctx.textAlign = 'center';
      ctx.textBaseline = 'middle';
      ctx.font = '700 15px "Avenir Next", "Segoe UI", sans-serif';

      for (let i = 0; i < messages.length; i++) {
        const armShift = (i % 2) * Math.PI;
        const turn = i * 0.95;
        const angle = t + armShift + turn;
        const radius = base * 0.6 + (i / (messages.length - 1)) * spread;
        const x = cx + Math.cos(angle) * radius;
        const y = cy + Math.sin(angle) * radius * 0.52;
        const a = 0.55 + 0.45 * (0.5 + 0.5 * Math.sin(t * 5 + i));

        ctx.fillStyle = `rgba(255,255,255,${a})`;
        ctx.shadowColor = i % 2 ? 'rgba(255,120,200,.66)' : 'rgba(120,230,255,.66)';
        ctx.shadowBlur = 14;
        ctx.fillText(messages[i], x, y);
      }
      ctx.restore();
    }

    function lerp(a, b, t) {
      return a + (b - a) * t;
    }

    function loop() {
      speed = lerp(speed, targetSpeed, 0.02);
      drawBackground();
      drawGlobalEffects();
      drawSpiralGalaxy();
      requestAnimationFrame(loop);
    }

    function showPhrase() {
      mainMessage.classList.remove('show');
      mainMessage.textContent = phrases[phraseIndex];
      phraseIndex = (phraseIndex + 1) % phrases.length;
      requestAnimationFrame(() => mainMessage.classList.add('show'));
    }

    function startTravel() {
      running = true;
      targetSpeed = 10;
      status.textContent = 'Saltando a la galaxia...';

      card.classList.add('hidden');
      travel.classList.add('active');
      travel.setAttribute('aria-hidden', 'false');

      showPhrase();
      phraseTimer = setInterval(showPhrase, 3200);

      setTimeout(() => {
        targetSpeed = 16;
        status.textContent = '';
      }, 1200);
    }

    function dodgeNo() {
      if (!noFloats) {
        status.textContent = 'Si dices no... no te muevas. 游땼';
        return;
      }

      const wrap = actions.getBoundingClientRect();
      const btn = noBtn.getBoundingClientRect();
      const x = Math.floor(Math.random() * Math.max(1, wrap.width - btn.width));
      const y = Math.floor(Math.random() * Math.max(1, wrap.height - btn.height));

      noBtn.style.position = 'absolute';
      noBtn.style.left = `${x}px`;
      noBtn.style.top = `${y}px`;
      status.textContent = 'Ese bot칩n no quiere decir que no. 游땐';
    }

    noBtn.addEventListener('mouseenter', dodgeNo);
    noBtn.addEventListener('touchstart', dodgeNo, { passive: true });

    noBtn.addEventListener('click', (e) => {
      e.preventDefault();
      noFloats = false;
      noBtn.style.position = 'static';
      noBtn.style.left = '';
      noBtn.style.top = '';
      status.textContent = 'Entonces... no te muevas. 游땼';
    });

    yesBtn.addEventListener('click', () => {
      yesBtn.disabled = true;
      noBtn.disabled = true;
      startTravel();
    });

    addEventListener('resize', resize);
    resize();
    loop();
  </script>
</body>
</html>
